<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <script
      src="https://kit.fontawesome.com/17a85d028c.js"
      crossorigin="anonymous"
    ></script>
    <link rel="stylesheet" href="src/styles/reset.css" />
    <link rel="stylesheet" href="src/styles/mainBanner.css" />
    <link rel="stylesheet" href="src/styles/modal.css" />

    <style>
      .movie-card {
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
        gap: 40px;
        padding: 30px 0 30px 0;
        background-color: #1c3825;
      }

      .section {
        width: 300px;
        height: 400px;
        padding: 16px;
        border-radius: 10px;
        display: flex;
        flex-direction: column;
        justify-content: flex-end;
        background-size: cover;
        background-position: center;
        cursor: pointer;
      }
    </style>

    <script type="module">
      import { modal } from "/src/components/modal.js";

      document.addEventListener("DOMContentLoaded", () => {
        modal();
      });
    </script>

    <script type="module">
      document.addEventListener("DOMContentLoaded", () => {
        const searchIcon = document.querySelector(".search-icon");
        const searchInput = document.querySelector(".searchInput");
        const movieCardContainer = document.querySelector(".movie-card");

        const options = {
          method: "GET",
          headers: {
            accept: "application/json",
            Authorization: `Bearer ${import.meta.env.VITE_TMDB_API_KEY}`,
          },
        };

        const searchMovies = (query) => {
          const url = `https://api.themoviedb.org/3/search/movie?query=${encodeURIComponent(
            query
          )}&include_adult=false&language=ko&page=1`;
          fetch(url, options)
            .then((res) => res.json())
            .then((res) => {
              movieCardContainer.innerHTML = "";
              res.results.forEach((movie) => {
                const div = document.createElement("div");
                div.className = "section";
                div.style.backgroundImage = `url(https://image.tmdb.org/t/p/w500${movie.poster_path})`;
                movieCardContainer.append(div);
              });
            })
            .catch((err) => console.error(err));
        };

        searchInput.addEventListener("keydown", (e) => {
          if (e.key === "Enter") {
            const query = e.target.value.trim();
            if (query) searchMovies(query);
          }
        });

        searchIcon.addEventListener("click", () => {
          const query = searchInput.value.trim();
          if (query) searchMovies(query);
        });
      });
    </script>
  </head>

  <body>
    <div class="main-banner">
      <p class="since">SUMMER 2025</p>
      <div class="search-container">
        <input
          class="searchInput"
          type="search"
          placeholder="검색어를 입력하세요"
        />
        <span style="color: white">
          <i class="search-icon fa-solid fa-magnifying-glass"></i>
        </span>
      </div>
    </div>

    <div class="movie-card"></div>
    <div class="overlay"></div>
    <div class="modal"></div>
  </body>
</html>
